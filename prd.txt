ì•„ë˜ëŠ” Android / iOS ë¡œì»¬ LLMì„ ì¶”ìƒí™”í•˜ëŠ” KMP Libraryì— ëŒ€í•œ ì‹¤í–‰ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ PRDë‹¤.
(ThinQÂ·KMPÂ·ëŒ€ê·œëª¨ ëª¨ë°”ì¼ ì•± ìš´ì˜ì„ ì „ì œë¡œ í•œ ì—”í„°í”„ë¼ì´ì¦ˆ/í”Œë«í¼ ê´€ì ìœ¼ë¡œ ì‘ì„±)

â¸»

ğŸ“˜ PRD

KMP ê¸°ë°˜ Local LLM Abstraction Library

(ê°€ì¹­: kmp-local-llm / ThinQ Local AI Core)

â¸»

1. ì œí’ˆ ê°œìš” (Overview)

1.1 ëª©ì 

Androidì™€ iOSì—ì„œ ì œê³µí•˜ëŠ” í”Œë«í¼ ë„¤ì´í‹°ë¸Œ On-device LLM ê¸°ëŠ¥ì„
Kotlin Multiplatform(KMP) ê¸°ë°˜ì˜ ë‹¨ì¼ ê³µí†µ APIë¡œ ì¶”ìƒí™”í•˜ì—¬:
	â€¢	ì•±/í”¼ì²˜ ë ˆë²¨ì—ì„œ í”Œë«í¼ ë¶„ê¸° ì—†ëŠ” AI ê¸°ëŠ¥ ê°œë°œ
	â€¢	ë¡œì»¬ AI ìš°ì„ (Local-first AI) ì „ëµ êµ¬í˜„
	â€¢	í´ë¼ìš°ë“œ LLM ì˜ì¡´ë„ ê°ì†Œ â†’ ë¹„ìš©/ì§€ì—°/í”„ë¼ì´ë²„ì‹œ ë¦¬ìŠ¤í¬ ìµœì†Œí™”
	â€¢	í–¥í›„ Cloud LLM / Hybrid LLM í™•ì¥ ê¸°ë°˜ í™•ë³´

â¸»

1.2 í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œ

ë¬¸ì œ	ì„¤ëª…
í”Œë«í¼ë³„ API íŒŒí¸í™”	Android(Gemini Nano/ML Kit), iOS(Foundation Models) API êµ¬ì¡°ê°€ ì™„ì „íˆ ìƒì´
ì¤‘ë³µ êµ¬í˜„	ìš”ì•½/ì¶”ì²œ/ì„¤ëª… ê¸°ëŠ¥ì„ AOS/iOS ê°ê° êµ¬í˜„
ê¸°ìˆ  ì¢…ì†	Feature ì½”ë“œê°€ í”Œë«í¼ LLM APIì— ì§ì ‘ ê²°í•©
í™•ì¥ì„± ë¶€ì¡±	Local â†’ Cloud â†’ Hybrid ì „í™˜ ì‹œ ëŒ€ê·œëª¨ ë¦¬íŒ©í† ë§ ë°œìƒ


â¸»

2. ë²”ìœ„ ì •ì˜ (Scope)

2.1 In Scope (ì´ë²ˆ ë²„ì „)
	â€¢	Android Local LLM (Gemini Nano / ML Kit GenAI)
	â€¢	iOS Local LLM (Apple Foundation Models)
	â€¢	Text ê¸°ë°˜ ìƒì„±/ìš”ì•½/ì¬ì‘ì„±
	â€¢	ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ (í”Œë«í¼ ì§€ì› ë²”ìœ„ ë‚´)
	â€¢	KMP ê³µí†µ API ì œê³µ
	â€¢	Swift Bridge í¬í•¨

2.2 Out of Scope (ì°¨ê¸°)
	â€¢	Vision / Multimodal Image ì…ë ¥
	â€¢	Tool Calling / Function Calling
	â€¢	Fine-tuning
	â€¢	ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ë¡œë”©
	â€¢	ì„œë²„ ê¸°ë°˜ LLM (ë‹¨, í™•ì¥ ê³ ë ¤)

â¸»

3. ì‚¬ìš©ì ë° ì´í•´ê´€ê³„ì

3.1 ì£¼ìš” ì‚¬ìš©ì
	â€¢	ThinQ Android / iOS ì•± ê°œë°œì
	â€¢	KMP Core / Feature ëª¨ë“ˆ ê°œë°œì
	â€¢	AI UX / Smart Home Feature ê¸°íšì

3.2 ì´í•´ê´€ê³„ì
	â€¢	Mobile Platform Lead
	â€¢	AI/AX ì¡°ì§
	â€¢	ë³´ì•ˆ / ê°œì¸ì •ë³´ ì¡°ì§
	â€¢	í’ˆì§ˆ(QA) ì¡°ì§

â¸»

4. ì•„í‚¤í…ì²˜ ëª©í‘œ

4.1 ì„¤ê³„ ì›ì¹™
	1.	Platform Agnostic
	â€¢	ê³µí†µ APIì— Android/iOS ìš©ì–´ ë…¸ì¶œ ê¸ˆì§€
	2.	Local-first
	â€¢	ê¸°ë³¸ ì‹¤í–‰ì€ í•­ìƒ On-device
	3.	Capability-based
	â€¢	í”Œë«í¼ë³„ ì§€ì› ê¸°ëŠ¥ì„ ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„
	4.	Fail-safe
	â€¢	ëª¨ë¸ ë¯¸ì§€ì›/ë¹„í™œì„± ìƒíƒœì—ì„œë„ ì•± ì•ˆì •ì„± ë³´ì¥
	5.	í™•ì¥ ê°€ëŠ¥
	â€¢	Cloud LLM, Hybrid êµ¬ì¡° í™•ì¥ ê°€ëŠ¥

â¸»

5. ëª¨ë“ˆ êµ¬ì¡°

core_llm/
 â”œâ”€ commonMain/
 â”‚   â”œâ”€ api/
 â”‚   â”‚   â”œâ”€ LocalLlmClient.kt
 â”‚   â”‚   â”œâ”€ LlmRequest.kt
 â”‚   â”‚   â”œâ”€ LlmResponse.kt
 â”‚   â”‚   â”œâ”€ LlmCapability.kt
 â”‚   â”‚   â””â”€ LlmError.kt
 â”‚   â”œâ”€ factory/
 â”‚   â”‚   â””â”€ LocalLlmClientFactory.kt
 â”‚   â””â”€ metrics/
 â”‚       â””â”€ LlmMetrics.kt
 â”‚
 â”œâ”€ androidMain/
 â”‚   â””â”€ AndroidLocalLlmClient.kt   (ML Kit GenAI)
 â”‚
 â”œâ”€ iosMain/
 â”‚   â””â”€ IosLocalLlmClient.kt       (Swift Bridge í˜¸ì¶œ)
 â”‚
 â””â”€ appleBridge/
     â””â”€ AppleLocalLlmBridge.swift


â¸»

6. ê³µí†µ API ì„¤ê³„

6.1 Core Interface

interface LocalLlmClient {

    suspend fun generateText(
        request: LlmRequest
    ): LlmResponse

    fun streamText(
        request: LlmRequest
    ): Flow<String>

    val capabilities: Set<LlmCapability>
}


â¸»

6.2 Request / Response ëª¨ë¸

data class LlmRequest(
    val prompt: String,
    val systemInstruction: String? = null,
    val maxTokens: Int = 512,
    val temperature: Double = 0.7,
    val metadata: Map<String, String> = emptyMap()
)

data class LlmResponse(
    val text: String,
    val usage: TokenUsage? = null,
    val raw: Any? = null
)


â¸»

6.3 Capability ëª¨ë¸

enum class LlmCapability {
    TEXT_GENERATION,
    SUMMARIZATION,
    REWRITING,
    PROOFREADING,
    STREAMING
}

â†’ Feature ì½”ë“œì—ì„œ capabilities.contains(...) ê¸°ë°˜ ë¶„ê¸° ê°€ëŠ¥

â¸»

6.4 Error ëª¨ë¸

sealed class LlmError : Exception() {
    class ModelNotAvailable : LlmError()
    class PermissionDenied : LlmError()
    class SafetyBlocked : LlmError()
    class Internal : LlmError()
}


â¸»

7. í”Œë«í¼ë³„ êµ¬í˜„ ì „ëµ

7.1 Android

í•­ëª©	ë‚´ìš©
ì—”ì§„	Gemini Nano (AICore)
API	ML Kit GenAI (Prompt/Summarization)
ì–¸ì–´	Kotlin
ìŠ¤íŠ¸ë¦¬ë°	ì œí•œì  / ë¯¸ì§€ì› â†’ ë‹¨ì¼ emit
í† í° ì œì–´	ì œí•œì  (ML Kit ë‚´ë¶€ ì •ì±…)

ì±…ì„
	â€¢	ëª¨ë¸ ë‹¤ìš´ë¡œë“œ/ê°€ìš©ì„± ì²´í¬
	â€¢	Safety ì˜ˆì™¸ ë§¤í•‘
	â€¢	ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ ì œí•œ ëŒ€ì‘

â¸»

7.2 iOS

í•­ëª©	ë‚´ìš©
ì—”ì§„	Apple Foundation Models
API	LanguageModelSession
ì–¸ì–´	Swift + KMM interop
ìŠ¤íŠ¸ë¦¬ë°	AsyncSequence ê¸°ë°˜
í† í° ì œì–´	ì˜µì…˜ìœ¼ë¡œ ì§€ì›

ì±…ì„
	â€¢	Swift Bridge ì œê³µ
	â€¢	ì„¸ì…˜ ìˆ˜ëª… ê´€ë¦¬
	â€¢	Apple Intelligence ë¹„í™œì„± ìƒíƒœ ì²˜ë¦¬

â¸»

8. Swift Bridge ìš”êµ¬ì‚¬í•­

8.1 ì—­í• 
	â€¢	Foundation Models API ìº¡ìŠí™”
	â€¢	ObjC compatible API ì œê³µ
	â€¢	async/streaming â†’ callback ë³€í™˜

8.2 í•„ìˆ˜ API

prepare()
generate(prompt, maxTokens, temperature)
generateStream(prompt, onChunk)


â¸»

9. ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ (NFR)

9.1 ì„±ëŠ¥
	â€¢	í‰ê·  ì‘ë‹µ ì§€ì—° < 1.5s (ìš”ì•½ 200 tokens ê¸°ì¤€)
	â€¢	UI thread blocking ê¸ˆì§€

9.2 ì•ˆì •ì„±
	â€¢	ëª¨ë¸ ë¯¸ì§€ì› ë‹¨ë§ì—ì„œ graceful failure
	â€¢	ì•± crash zero tolerance

9.3 ë³´ì•ˆ/í”„ë¼ì´ë²„ì‹œ
	â€¢	ì‚¬ìš©ì ì…ë ¥/ì¶œë ¥ ë°ì´í„° ì™¸ë¶€ ì „ì†¡ ê¸ˆì§€
	â€¢	ë¡œê·¸ì— prompt/response ì›ë¬¸ ì €ì¥ ê¸ˆì§€ (ì˜µì…˜í™”)

â¸»

10. Metrics & Observability

10.1 ìˆ˜ì§‘ í•­ëª© (ì„ íƒ)
	â€¢	ìš”ì²­ ì„±ê³µ/ì‹¤íŒ¨ìœ¨
	â€¢	í‰ê·  ì‘ë‹µ ì‹œê°„
	â€¢	ëª¨ë¸ ê°€ìš©ì„± ë¹„ìœ¨
	â€¢	capabilityë³„ ì‚¬ìš© ë¹ˆë„

interface LlmMetricsReporter {
    fun onRequestStart()
    fun onRequestSuccess(durationMs: Long)
    fun onRequestFailure(error: LlmError)
}


â¸»

11. í™•ì¥ ê³„íš (vNext)

í•­ëª©	ì„¤ëª…
CloudLlmClient	OpenAI/Gemini API
HybridLlmClient	Local ì‹¤íŒ¨ ì‹œ Cloud fallback
Prompt Template Engine	ê³µí†µ í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
Safety Policy Layer	ì •ì±… ê¸°ë°˜ ì‘ë‹µ í•„í„°
Multimodal	Image + Text


â¸»

12. ì„±ê³µ ì§€í‘œ (KPI)

ê²°ê³¼ KPI
	â€¢	AI Feature ê³µí†µ ì½”ë“œ ë¹„ìœ¨ â‰¥ 80%
	â€¢	Android/iOS AI ê¸°ëŠ¥ ì¶œì‹œ ë¦¬ë“œíƒ€ì„ 30%â†“
	â€¢	Cloud LLM í˜¸ì¶œ ë¹„ìš© ì ˆê°

ê³¼ì • KPI
	â€¢	KMP Featureì—ì„œ í”Œë«í¼ ë¶„ê¸° ì œê±°ìœ¨
	â€¢	Local LLM ì„±ê³µ í˜¸ì¶œë¥ 
	â€¢	í‰ê·  ì‘ë‹µ ì‹œê°„ ì¶”ì´

â¸»

13. ì „ëµì  ê°€ì¹˜
	â€¢	ThinQ KMP Coreì˜ í•µì‹¬ ì°¨ë³„í™” ìì‚°
	â€¢	â€œOn-device AI SDKâ€ë¡œ ë‚´ë¶€ ì¬ì‚¬ìš© ê°€ëŠ¥
	â€¢	í–¥í›„ AI UX / Agentic UXì˜ ê¸°ë°˜ ë ˆì´ì–´
	â€¢	ì™¸ì£¼/í”Œë«í¼ ì¢…ì† ìµœì†Œí™”